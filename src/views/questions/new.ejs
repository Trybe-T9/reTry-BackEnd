<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nova pergunta</title>
</head>
<body>
  <header>Adicionar pergunta</header>
  <main>
    <form action="/api/v1/questions" method="POST">
      <label>
        Pergunta: 
        <input type="text" name="question" />
      </label>
      <label>
        Tipo:
        <select name="type" id="type">
          <option value="multi-choice">Multipla escolha</option>
          <option value="boolean">Verdadeiro ou falso</option>
        </select>
      </label>
      <label>
        Dificuldade:
        <select name="difficulty">
          <option value="1">Fácil</option>
          <option value="2">Médio</option>
          <option value="3">Difícil</option>
        </select>
      </label>
      <label>
        Tema:
        <input type="text" name="theme" />
      </label>
      <label>
        Imagem:
        <input type="file" name="image" />
      </label>
      <label>
        Modulo:
        <select name="module_id">
          <option value="efff8570-5cb7-4090-bd58-46f4b5a335a6">Fundamentos</option>
          <option value="a5df9455-4d7f-4f52-94cb-eb830b416cad">Front-end</option>
          <option value="afdd5680-b811-4aeb-b229-6e7f3351bd01">Back-end</option>
          <option value="f3ec9930-d2e3-4423-88e8-a28c6aa0265a">Ciência da computação</option>
        </select>
      </label>
      <label>
        Bloco:
        <input type="number" name="block" min="1" max="38" />
      </label>
      <fieldset id="answers">
      </fieldset>
      <button type="submit">Salvar</button>
    </form>
    <script>
      const selectType = document.querySelector('#type');

      const newAnswer = (index) => {
        const label = document.createElement('label');
        label.innerText = 'Resposta: ';

        const answer = document.createElement('input');
        answer.name = `answers[${index}][answer]`;
        answer.type = 'text';

        label.appendChild(answer);

        return label;
      }

      const newRight = (index) => {
        const label = document.createElement('label');
        label.innerText = 'Resposta: ';

        const select = document.createElement('select');
        select.name = `answers[${index}][isRight]`;

        const optionTrue = document.createElement('option');
        optionTrue.value = 'true';
        optionTrue.innerText = 'Correta';

        const optionFalse = document.createElement('option');
        optionFalse.value = 'false';
        optionFalse.innerText = 'Errada';

        select.appendChild(optionTrue);
        select.appendChild(optionFalse);

        label.appendChild(select);

        return label;
      }

      const newHint = (index) => {
        const label = document.createElement('label');
        label.innerText = 'Dica: ';

        const hint = document.createElement('textarea');
        hint.name = `answers[${index}][hint]`;

        label.appendChild(hint);

        return label;
      }

      const newLink = (index) => {
        const label = document.createElement('label');
        label.innerText = 'Link: ';

        const link = document.createElement('input');
        link.name = `answers[${index}][link]`;
        link.type = 'text';

        label.appendChild(link);

        return label;
      }

      const createAnswers = (qtt) => {
        const field = document.querySelector('#answers');

        field.innerHTML = '';

        for(let index = 0; index < qtt; index += 1) {
          const label = document.createElement('label');
          label.innerText = `Resposta - ${index + 1}`;

          label.appendChild(newAnswer(index));
          label.appendChild(newRight(index));
          label.appendChild(newHint(index));
          label.appendChild(newLink(index));

          field.appendChild(label);
        }
      };

      selectType.addEventListener('change', () => {
        const type = document.querySelector('#type').value;

        if(type === 'multi-choice') createAnswers(4);

        createAnswers(2);
      });

      createAnswers(4);
    </script>
  </main>
</body>
</html>